---
title: "Playwright„ÅÆ„Ç≥„Éº„Éâ„Çπ„Éã„Éö„ÉÉ„Éà"
emoji: "üé≠"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: ["playwright", "typescript", "test", "testing", "web"]
published: true
---

## „ÅØ„Åò„ÇÅ„Å´

Web„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ„Çà„Åè„ÅÇ„ÇãÊìç‰Ωú„Å´„Å§„ÅÑ„Å¶„ÄÅPlaywright„ÅÆ„Ç≥„Éº„Éâ„Çπ„Éã„Éö„ÉÉ„Éà„ÇíË®òËø∞„Åó„Åæ„Åô„ÄÇ
ÈöèÊôÇÊõ¥Êñ∞‰∫àÂÆö„Åß„Åô„ÄÇ

## „Ç§„Éô„É≥„Éà

### Êñ∞„Åó„ÅÑ„Çø„Éñ„ÇíÈñã„Åè

`BrowserContext` „ÇØ„É©„Çπ„ÅÆ [`waitForEvent("page")`](https://playwright.dev/docs/api/class-browsercontext#browser-context-wait-for-event) „É°„ÇΩ„ÉÉ„Éâ„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ

```typescript
import { test, Page } from "@playwright/test";

test("Êñ∞„Åó„ÅÑ„Çø„Éñ„ÇíÈñã„Åè", async ({ context, page }) => {
  const newTabPromise: Promise<Page> = context.waitForEvent("page");
  // Êñ∞„Åó„ÅÑ„Çø„Éñ„ÇíÈñã„ÅèÊìç‰Ωú
  await page.getByRole('button', {name: "Êñ∞„Åó„ÅÑ„Éö„Éº„Ç∏"}).click();
  const newTab: Page = await newTabPromise;
  await newTab.waitForLoadState("domcontentloaded");
  // Êñ∞„Åó„ÅÑ„Çø„Éñ„Åß„ÅÆÊìç‰Ωú

});
```

### „ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„Åè

`Page` „ÇØ„É©„Çπ„ÅÆ [`waitForEvent("dialog")`](https://playwright.dev/docs/api/class-page#page-wait-for-event) „É°„ÇΩ„ÉÉ„Éâ„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ

```typescript
import { test } from "@playwright/test";

test("„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„Åè", async ({ page }) => {
  // „ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„ÅèÊìç‰Ωú
  await page.getByRole("button", { name: "„É≠„Ç∞„Ç¢„Ç¶„Éà" }).click();
  page.on("dialog", async (dialog) => {
    await dialog.accept();
  });
  // „É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åü„Åì„Å®„ÇíÁ¢∫Ë™ç
});
```

### „Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ

`Page` „ÇØ„É©„Çπ„ÅÆ [`waitForEvent("download")`](https://playwright.dev/docs/api/class-page#page-wait-for-event) „É°„ÇΩ„ÉÉ„Éâ„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ

```typescript
import fs from "fs";
import { Download } from "playwright";
import { test, expect } from "@playwright/test";

test("„Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ", async ({ page }) => {
  const downloadPromise: Promise<Download> = page.waitForEvent("download");
  // „Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊìç‰Ωú
  await page.getByRole("button", { name: "„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ" }).click();
  const download: Download = await downloadPromise;
  const filePath: string = "downloaded.txt";
  await download.saveAs(filePath);
  // „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åü„Éï„Ç°„Ç§„É´„ÅÆÂ≠òÂú®Á¢∫Ë™ç
  expect(fs.existsSync(filePath)).toBeTruthy();
});
```

### „Éï„Ç°„Ç§„É´„ÅÆ„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ

`Page` „ÇØ„É©„Çπ„ÅÆ [`waitForEvent("filechooser")`](https://playwright.dev/docs/api/class-page#page-wait-for-event) „É°„ÇΩ„ÉÉ„Éâ„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÄÇ

```typescript
import fs from "fs";
import { FileChooser } from "playwright";
import { test, expect } from "@playwright/test";

test("„Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ", async ({ page }) => {
  const fileChooserPromise: Promise<FileChooser> = page.waitForEvent("filechooser");
  await page.getByRole("button", { name: "„Éï„Ç°„Ç§„É´ÈÅ∏Êäû" }).click();
  const fileChooser: FileChooser = await fileChooserPromise;
  const filePath: string = "toUpload.txt";
  await fileChooser.setFiles(filePath);
  await page.getByRole("button", { name: "„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ" }).click();
  // „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„ÅåÂÆå‰∫Ü„Åó„Åü„Åì„Å®„ÇíÁ¢∫Ë™ç
});
```

## „Çª„ÉÉ„Ç∑„Éß„É≥„ÅÆ‰øùÂ≠ò

ÂèÇËÄÉ: [Authentication - Playwright docs](https://playwright.dev/docs/auth)

```typescript
import { test as setup, expect } from '@playwright/test';

const sessionFile = '.session/user.json';

setup('„É≠„Ç∞„Ç§„É≥', async ({ page }) => {
  // Perform authentication steps. Replace these actions with your own.
  await page.goto('/login');
  await page.getByLabel('„Ç¢„Ç´„Ç¶„É≥„ÉàÂêç').fill('username');
  await page.getByLabel('„Éë„Çπ„ÉØ„Éº„Éâ').fill('password');
  await page.getByRole('button', { name: '„É≠„Ç∞„Ç§„É≥' }).click();
  await page.waitForURL('/home');
  await expect(page.getByRole('heading', { name: 'Welcome to HOME' })).toBeVisible();

  // End of authentication steps.

  await page.context().storageState({ path: authFile });
});
```

<!-- qiita article id: fab53e0b579d3f18c5ef -->
