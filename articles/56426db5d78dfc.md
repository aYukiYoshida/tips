---
title: "Playwrightã§ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ä¿æŒã™ã‚‹"
emoji: "ğŸ­"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["playwright", "typescript", "test", "testing", "web"]
published: true
---

## ã¯ã˜ã‚ã«

Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆã§ã€Œã‚ã‚‰ã‹ã˜ã‚ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸçŠ¶æ…‹ã‹ã‚‰ãƒ†ã‚¹ãƒˆã‚’å§‹ã‚ãŸã„ã€ã¨ã„ã†ã®ã¯ã‚ˆãã‚ã‚‹ãƒ‹ãƒ¼ã‚ºã§ã™ã€‚Playwrightã§ã¯ã€[Authentication](https://playwright.dev/docs/auth)ã«ã‚ã‚‹ã‚ˆã†ã«ã€ãƒ­ã‚°ã‚¤ãƒ³å¾Œã® browser state ã‚’ä¿å­˜ã—ã¦ã€ä½¿ã„å›ã™ã®ãŒåŸºæœ¬çš„ãªå®Ÿè£…æ–¹æ³•ã§ã™ã€‚ã“ã“ã§ã¯ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã®ä¿æŒ

### ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¿å­˜

```typescript:tests/auth.setup.ts
import { test as setup, expect } from '@playwright/test';

const sessionFile = '.auth/user.json';

setup('ãƒ­ã‚°ã‚¤ãƒ³', async ({ page }) => {
  // Perform authentication steps. Replace these actions with your own.
  await page.goto('/login');
  await page.getByLabel('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå').fill('username');
  await page.getByLabel('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰').fill('password');
  await page.getByRole('button', { name: 'ãƒ­ã‚°ã‚¤ãƒ³' }).click();
  await page.waitForURL('/home');
  await expect(page.getByRole('heading', { name: 'Welcome to HOME' })).toBeVisible();

  // End of authentication steps.

  await page.context().storageState({ path: sessionFile });
});
```

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ä½¿ã†ãŸã‚ã®è¨­å®š

ãƒã‚¤ãƒ³ãƒˆã¯ã€ä»¥ä¸‹ã®2ç‚¹ã§ã™ã€‚

1. `chromium` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `dependencies` ã« `setup` ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œå‰ã« `setup` ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚
2. `chromium` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `use` ã« `storageState` ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œæ™‚ã« `setup` ã§ä¿å­˜ã—ãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã™ã‚‹ã€‚

```typescript:playwright.config.ts
import { defineConfig, devices } from '@playwright/test';

export default defineConfig({
  projects: [
    // Setup project
    { name: 'setup', testMatch: /.*\.setup\.ts/ },

    {
      name: 'chromium',
      use: {
        ...devices['Desktop Chrome'],
        // Use prepared auth state.
        storageState: '.auth/user.json',
      },
      dependencies: ['setup'],
    },
  ],
});
```
